<?xml version="1.0" encoding="utf-8"?>
<ScoreDef xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" UID="0d6e23bb-12aa-46e8-b1ad-55ec64417d82" SyntaxVersion="1" DataModelVersion="13" Object="device" Name="Device Health" Status="enabled" InObjectView="true">
  <Platforms>
    <Platform>windows</Platform>
  </Platforms>
  <ScopeQuery>
    <Filtering>
			(where device
			(ne device_type (enum server))
			(lt number_of_days_since_last_seen (integer 30)))
		</Filtering>
  </ScopeQuery>
  <ComputationSchedule>
    <Every>1h</Every>
  </ComputationSchedule>
  <Thresholds>
    <Threshold Color="red">
      <Keyword From="0" Label="Critical" />
    </Threshold>
    <Threshold Color="yellow">
      <Keyword From="5" Label="Bad" />
    </Threshold>
    <Threshold Color="green">
      <Keyword From="9" Label="Good" />
    </Threshold>
  </Thresholds>
  <CompositeScore UID="952804f5-ab30-47fd-ab74-1bdc93fe20bb" Name="Device Health" Description="Indicates the overall device health score." Visibility="visible" Weight="1">
    <Operation>
      <Average />
    </Operation>
    <CompositeScore UID="f5a6b700-2ecf-4e86-a1f0-491f6e029521" Name="Stability" Description="Indicates the overall stability score." Visibility="visible" Weight="1">
      <Operation>
        <WeightedAverage />
      </Operation>
      <LeafScore UID="99963776-18bd-41e6-86cc-61c94ba6503f" Name="BSOD" Description="Indicates the number of BSOD in the last 7 days" Visibility="visible" Weight="1">
        <Input>
          <Computation Name="Number of system crashes last 7 days" Description="" UID="87c1fc3c-58c2-4a8d-85f9-3ae7cf9318f7">
            <Query Output="number_of_errors" DefaultOutputValue="0">
							(select (id)
							(from device
							(with device_error
							(where device_error (eq type (enum system_crash)))
							(compute number_of_errors)
							(between now-7d now))))
						</Query>
          </Computation>
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0" Score="10" />
            </Range>
            <Range>
              <From Value="1" Score="5" />
            </Range>
            <Range>
              <From Value="2" Score="0" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Header>Blue Screen of Death (BSOD)</Header>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								This value represents the number of system crash during the last 7 days.
								- If the number is 0, the score is 10
								- If the number is 1, the score is 5
								- If the number is 2 or more, the score is 0
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3ECrashes%20last%207%20days%3C%2FLabel%3E%3CObject%3Esource_error%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3Cstring%3Evalue%3C%2Fstring%3E%3Cstring%3Einfo%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Esource_error%3C%2FObject%3E%3CField%3Estatus%3C%2FField%3E%3CComparer%3E%3D%3C%2FComparer%3E%3CValue%3Ebluescreen%3C%2FValue%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">List of crashes during last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
      <LeafScore UID="2ca4e2e8-23a0-4259-af8d-cab26386af19" Name="Hard reset" Description="Indicates the number of Hard Reset in the last 7 days" Visibility="visible" Weight="1">
        <Input>
          <Computation Name="Number of hard reset last 7 days" Description="" UID="6c0f15a0-8714-40df-b627-1706e056b432">
            <Query Output="number_of_errors" DefaultOutputValue="0">
							(select (id)
							(from device
							(with device_error
							(where device_error (eq type (enum "hard reset")))
							(compute number_of_errors)
							(between now-7d now))))
						</Query>
          </Computation>
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0" Score="10" />
            </Range>
            <Range>
              <From Value="1" Score="7" />
            </Range>
            <Range>
              <From Value="2" Score="3" />
            </Range>
            <Range>
              <From Value="4" Score="0" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Header>Hard Reset</Header>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								This value represents the number of hard reset during the last 7 days.
								- If the number is 0, the score is 10
								- If the number is 1, the score is 7
								- If the number is 2, the score is 3
								- If the number is 4 or more, the score is 0
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3EHard%20Reset%20last%207%20days%3C%2FLabel%3E%3CObject%3Esource_error%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3Cstring%3Evalue%3C%2Fstring%3E%3Cstring%3Einfo%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Esource_error%3C%2FObject%3E%3CField%3Estatus%3C%2FField%3E%3CComparer%3E%3D%3C%2FComparer%3E%3CValue%3Eimproper_shutdown%3C%2FValue%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">List of Hard Reset during last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
      <LeafScore UID="253ea6c3-f592-475e-8f22-18e23ebc18d3" Name="SMART disk failure" Description="Indicates the number of SMART disk failure in the last 7 days" Visibility="visible" Weight="1">
        <Input>
          <Computation Name="Number of SMART disk failure last 7 days" Description="" UID="451fb6c8-617e-4067-bc29-ea4f5d9d9e56">
            <Query Output="number_of_errors" DefaultOutputValue="0">
							(select (id)
							(from device
							(with device_error
							(where device_error (eq type (enum "SMART disk failure")))
							(compute number_of_errors)
							(between now-7d now))))
						</Query>
          </Computation>
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0" Score="10" />
            </Range>
            <Range>
              <From Value="1" Score="5" />
            </Range>
            <Range>
              <From Value="2" Score="0" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Header>SMART disk failure</Header>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								This value represents the number of smart disk failure during the last 7 days.
								- If the number is 0, the score is 10
								- If the number is 1, the score is 5
								- If the number is 2 or more, the score is 0
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3ESmart%20disk%20failure%20last%207%20days%3C%2FLabel%3E%3CObject%3Esource_error%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3Cstring%3Evalue%3C%2Fstring%3E%3Cstring%3Einfo%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Esource_error%3C%2FObject%3E%3CField%3Estatus%3C%2FField%3E%3CComparer%3E%3D%3C%2FComparer%3E%3CValue%3Esmart%3C%2FValue%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">List of Smart disk failure during last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
    </CompositeScore>
    <CompositeScore UID="b13c1f27-e08c-4f36-b1d7-ee54f97dd3dd" Name="Hardware" Description="Indicates the overall hardware score." Visibility="visible" Weight="1">
      <Operation>
        <WeightedAverage />
      </Operation>
      <LeafScore UID="67a983d9-17cc-4db7-8316-1784ba596594" Name="CPU load" Description="Indicates the High CPU time ratio during the last 7 days" Visibility="visible" Weight="1">
        <Input>
          <Computation Name="High device overall cpu time ratio last 7 days" Description="" UID="396cfa75-5a9e-4ac9-b180-1d98cf60be4f">
            <Query Output="high_device_overall_cpu_time_ratio" DefaultOutputValue="0">
							(select (id)
							(from device
							(with device_warning
							(between now-7d now)
							(compute high_device_overall_cpu_time_ratio))))
						</Query>
          </Computation>
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0.00" Score="10" />
            </Range>
            <Range>
              <From Value="0.05" Score="8" />
            </Range>
            <Range>
              <From Value="0.10" Score="5" />
            </Range>
            <Range>
              <From Value="0.20" Score="2" />
            </Range>
            <Range>
              <From Value="0.50" Score="0" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Header>CPU Time Ratio</Header>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								This value represents the time during which the device was using more than 70% of the CPU compared to the device uptime on the last 7 days

								Example: uptime during last 7 days = 1h, high cpu time = 15 min  =&gt; CPU Time Ratio = 25%

								Investigate the device timeline to find out more about those events
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3EHigh%20CPU%20events%20last%207%20days%3C%2FLabel%3E%3CObject%3Esource_event%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Elast_time%3C%2Fstring%3E%3Cstring%3Eduration%3C%2Fstring%3E%3Cstring%3Ereal_duration%3C%2Fstring%3E%3Cstring%3Einfo%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Esource_event%3C%2FObject%3E%3CField%3Enormalized_high_cpu%3C%2FField%3E%3CComparer%3E%26gt%3B%3D%3C%2FComparer%3E%3CValue%3E70%3C%2FValue%3E%3COperand%3Eratio_int%3C%2FOperand%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">List of High CPU usage events last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
      <LeafScore UID="cf1fa326-71b9-4b0f-b494-4eebb7a79e5d" Name="Memory load" Description="Indicates the High Memory time ratio during the last 7 days" Visibility="visible" Weight="1">
        <Input>
          <Computation Name="Cumulated warning duration for high memory usage last 7 days" Description="" UID="3047f744-1ca8-498b-b3f5-7e79c9323382">
            <Query Output="high_device_memory_time_ratio" DefaultOutputValue="0">
							(select (id)
							(from device
							(with device_warning
							(between now-7d now)
							(compute high_device_memory_time_ratio))))
						</Query>
          </Computation>
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0.00" Score="10" />
            </Range>
            <Range>
              <From Value="0.05" Score="8" />
            </Range>
            <Range>
              <From Value="0.10" Score="5" />
            </Range>
            <Range>
              <From Value="0.20" Score="2" />
            </Range>
            <Range>
              <From Value="0.50" Score="0" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Header>Memory Time Ratio</Header>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								This value represents the time during which the device was using more than 70% of the Memory compared to the device uptime on the last 7 days

								Example: uptime during last 7 days = 1h, high memory time = 30 min  =&gt; CPU Time Ratio = 50%

								Investigate the device timeline to find out more about those events
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3EHigh%20Memory%20events%20last%207%20days%3C%2FLabel%3E%3CObject%3Esource_event%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Elast_time%3C%2Fstring%3E%3Cstring%3Eduration%3C%2Fstring%3E%3Cstring%3Ereal_duration%3C%2Fstring%3E%3Cstring%3Einfo%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Esource_event%3C%2FObject%3E%3CField%3Ehigh_memory%3C%2FField%3E%3CComparer%3E%26gt%3B%3D%3C%2FComparer%3E%3CValue%3E70%3C%2FValue%3E%3COperand%3Eratio_int%3C%2FOperand%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">List of high memory events during last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
    </CompositeScore>
    <CompositeScore UID="3209e91f-24dc-4465-afe5-b873d023d88f" Name="Disk" Description="Indicates the overall disk score." Visibility="visible" Weight="1">
      <Operation>
        <WeightedAverage />
      </Operation>
      <LeafScore UID="b1c435c4-20ba-412b-8946-87d38daad7fe" Name="SMART disk index" Description="Indicates the Smart disk index" Visibility="visible" Weight="1">
        <Input>
          <Field Name="disks_smart_index" />
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0.0" Score="0" />
              <To Value="1.0" Score="10" />
            </Range>
            <Range>
              <From Value="1.0" Score="10" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								Based on the IT best practices used by software and hardware vendors, Nexthink uses an algorithm in charge of computing the values coming from the Collector and storing only one value, the result of the combination of the the S.M.A.R.T. values, the S.M.A.R.T. index.

								Having a low value for the S.M.A.R.T. index is not necessarily alarming as it won't tell you that the hard drive will fail or the endpoint system will have issues straight away or in 56 minutes or in 2 weeks. What it does tell you is that the values reported by the Collector are making us lower the degree of confidence we have in the hard drive. When the index value is very low, it's time to ask the IT technician to go on site and use the proprietary software to have the official diagnostic.

								Algorithm
								The algorithm will take the following items into account to estimate the index.

								• Power Cycle Count
								• Reallocation Event Count
								• Current Pending Sector Count
								• Reallocated Sectors Count
								• Uncorrectable Sector Count
								• Load Cycle Count
								• Write Error Rate

							</Description>
            </Section>
            <Section>
              <Title>Limitations</Title>
              <Description>
								• The hard disk manufacturers designing and producing the hardware and the associated software have their own protocol and have their own way of interrogating their components. This is not something that is necessarily publicly made available. A part of it maybe, but not all of it. So it is very difficult to provide detailed information about the actual state of the disk.

								• In order to reduce the space used by the Engine database and prevent the Engine process to be overloaded with S.M.A.R.T. values, the Engine does not keep the history of the S.M.A.R.T. values.
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3ESmart%20disk%20failure%20last%207%20days%3C%2FLabel%3E%3CObject%3Esource_error%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3Cstring%3Evalue%3C%2Fstring%3E%3Cstring%3Einfo%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Esource_error%3C%2FObject%3E%3CField%3Estatus%3C%2FField%3E%3CComparer%3E%3D%3C%2FComparer%3E%3CValue%3Esmart%3C%2FValue%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">List of Smart disk failure during last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
      <LeafScore UID="d083ad50-079c-4689-a7ba-c860179d6578" Name="System drive free space" Description="Indicates the System drive free space" Visibility="visible" Weight="1">
        <Input>
          <Field Name="system_drive_free_space" />
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="1" Score="0" />
            </Range>
            <Range>
              <From Value="2147483648" Score="5" />
              <To Value="10737418240" Score="10" />
            </Range>
            <Range>
              <From Value="10737418240" Score="10" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Header>System free space</Header>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								Indicates the amount of disk space left on the System drive.
								- Over 10GB, the score is 10
								- Between 10GB and 2GB, the score will decrease linearly from 10 to 5
								- Below 2GB, the score is 0
							</Description>
            </Section>
            <Section>
              <Title>Remediation</Title>
              <Description>
								Click on the link below to remotely launch a cleanup on the device.
								
								The user will be able to choose from:
								- Light clean: clean recycle bin and temporary internet files
								- Deep clean: also cleans your downloads folder
							</Description>
              <RemoteAction Name="Disk Cleanup" UID="a190ad5b-2921-3a0d-5dc4-bfa408b4feda" />
              <Description>
								In case you want to clean memory dump files, use the following link:
							</Description>
              <RemoteAction Name="Remove Memory Dump Files" UID="290d3d99-3732-a3e4-f71c-78b27d1e19a9" />
            </Section>
          </Sections>
        </Document>
      </LeafScore>
    </CompositeScore>
    <CompositeScore UID="87f9ca40-9e40-4a5f-b6b8-399c8de205a3" Name="Startup" Description="Indicates the overall startup score." Visibility="visible" Weight="1">
      <Operation>
        <Average />
      </Operation>
      <CompositeScore UID="42178bb1-180e-4070-860e-576be2115ba3" Name="Logon" Description="Indicates the logon experience score." Visibility="visible" Weight="1">
        <Operation>
          <WeightedAverage />
        </Operation>
        <LeafScore UID="88f2849c-f7a1-421a-8c40-3efe2a853be0" Name="Last Logon duration" Description="Indicates the last logon duration experience score." Visibility="visible" Weight="1">
          <Input>
            <Field Name="last_logon_duration" />
          </Input>
          <Normalization>
            <Ranges>
              <Range>
                <From Value="0.001" Score="10" />
              </Range>
              <Range>
                <From Value="15000" Score="8" />
              </Range>
              <Range>
                <From Value="30000" Score="5" />
              </Range>
              <Range>
                <From Value="60000" Score="2" />
              </Range>
              <Range>
                <From Value="120000" Score="0" />
              </Range>
            </Ranges>
          </Normalization>
          <Document>
            <Sections>
              <Section>
                <Title>Description</Title>
                <Description>
									This score represents the duration of the last logon on the device.
								</Description>
              </Section>
              <Section>
                <Title>Values</Title>
                <Description>
									If the logon duration is:

									• Between 0 and 15 seconds -&gt; score is 10

									• Between 15 and 30 secondes -&gt; score is 8

									• Between 30 and 60 secondes -&gt; score is 5

									• Between 60 and 120 secondes -&gt; score is 2

									• More than 120 seconds -&gt; score is 0
								</Description>
              </Section>
              <Section>
                <Title>Investigation</Title>
                <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3ELogon%20events%20last%207%20days%3C%2FLabel%3E%3CObject%3Elogon%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Eduration%3C%2Fstring%3E%3Cstring%3Ereal_duration%3C%2Fstring%3E%3Cstring%3Euser_name%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Elogon%3C%2FObject%3E%3CField%3Etime%3C%2FField%3E%3CComparer%3E%3Dperiod%3C%2FComparer%3E%3CValue%20%2F%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">Logon events during last 7 days</HTTP>
              </Section>
            </Sections>
          </Document>
        </LeafScore>
        <LeafScore UID="eb5de550-c0d1-4a7b-abe9-41f75d52e7ae" Name="Logon duration baseline" Description="Indicates the logon duration experience score." Visibility="visible" Weight="1">
          <Input>
            <Field Name="average_logon_duration" />
          </Input>
          <Normalization>
            <Ranges>
              <Range>
                <From Value="0.001" Score="10" />
              </Range>
              <Range>
                <From Value="15000" Score="8" />
              </Range>
              <Range>
                <From Value="30000" Score="5" />
              </Range>
              <Range>
                <From Value="60000" Score="2" />
              </Range>
              <Range>
                <From Value="120000" Score="0" />
              </Range>
            </Ranges>
          </Normalization>
          <Document>
            <Sections>
              <Section>
                <Title>Description</Title>
                <Description>
									This score represents the average logon duration of users on the device.

									The logon duration is calculated as the time between the user authentication and when the desktop appears.
								</Description>
              </Section>
              <Section>
                <Title>Values</Title>
                <Description>
									If the logon duration is:

									• Between 0 and 15 seconds -&gt; score is 10

									• Between 15 and 30 secondes -&gt; score is 8

									• Between 30 and 60 secondes -&gt; score is 5

									• Between 60 and 120 secondes -&gt; score is 2

									• More than 120 seconds -&gt; score is 0
								</Description>
              </Section>
            </Sections>
          </Document>
        </LeafScore>
        <LeafScore UID="5c91b6dc-75cc-47a1-ac41-304f0c7e372b" Name="Extended logon duration baseline" Description="Indicates the extended logon duration experience score." Visibility="visible" Weight="1">
          <Input>
            <Field Name="extended_logon_duration_baseline" />
          </Input>
          <Normalization>
            <Ranges>
              <Range>
                <From Value="0.001" Score="10" />
              </Range>
              <Range>
                <From Value="30000" Score="8" />
              </Range>
              <Range>
                <From Value="60000" Score="5" />
              </Range>
              <Range>
                <From Value="120000" Score="2" />
              </Range>
              <Range>
                <From Value="240000" Score="0" />
              </Range>
            </Ranges>
          </Normalization>
          <Document>
            <Sections>
              <Section>
                <Title>Description</Title>
                <Description>
									This score represents the extended logon duration baseline on the device.

									The extended logon duration is the time between the user authentication and when the device is considered as ready to use.

									Nexthink consider a device as ready to use if:

									• CPU usage is below 15%

									• Hard drive usage is below 80%
								</Description>
              </Section>
              <Section>
                <Title>Values</Title>
                <Description>
									If the logon duration is:

									• Between 0 and 30 seconds -&gt; score is 10

									• Between 30 and 60 seconds -&gt; score is 8

									• Between 60 and 120 seconds -&gt; score is 5

									• Between 120 and 240 seconds -&gt; score is 2

									• More than 240 seconds -&gt; score is 0
								</Description>
              </Section>
            </Sections>
          </Document>
        </LeafScore>
      </CompositeScore>
      <CompositeScore UID="c0bcc413-fe8d-4553-9598-54b2deaa0bb4" Name="Boot" Description="Indicates the system boot experience score." Visibility="visible" Weight="1">
        <Operation>
          <WeightedAverage />
        </Operation>
        <LeafScore UID="e73f97ba-aa1b-4828-9060-7fafc986daab" Name="Last boot duration" Description="Indicates the last boot duration experience score." Visibility="visible" Weight="1">
          <Input>
            <Field Name="last_boot_duration" />
          </Input>
          <Normalization>
            <Ranges>
              <Range>
                <From Value="0.001" Score="10" />
              </Range>
              <Range>
                <From Value="15000" Score="8" />
              </Range>
              <Range>
                <From Value="30000" Score="5" />
              </Range>
              <Range>
                <From Value="60000" Score="2" />
              </Range>
              <Range>
                <From Value="120000" Score="0" />
              </Range>
            </Ranges>
          </Normalization>
          <Document>
            <Sections>
              <Section>
                <Title>Description</Title>
                <Description>
									This score represents the last boot duration on the device.
								</Description>
              </Section>
              <Section>
                <Title>Values</Title>
                <Description>
									If the boot duration is:

									• Between 0 and 15 seconds -&gt; score is 10

									• Between 15 and 30 seconds -&gt; score is 8

									• Between 30 and 60 seconds -&gt; score is 5

									• Between 60 and 120 seconds -&gt; score is 2

									• More than 120 seconds -&gt; score is 0
								</Description>
              </Section>
              <Section>
                <Title>Investigation</Title>
                <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3EBoot%20events%20last%207%20days%3C%2FLabel%3E%3CObject%3Eboot%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Evalue%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">Boot events during last 7 days</HTTP>
              </Section>
            </Sections>
          </Document>
        </LeafScore>
        <LeafScore UID="dcad589d-00f9-4881-afcd-7a5e72b6045a" Name="Boot duration baseline" Description="Indicates the boot duration experience score." Visibility="visible" Weight="1">
          <Input>
            <Field Name="average_boot_duration" />
          </Input>
          <Normalization>
            <Ranges>
              <Range>
                <From Value="0.001" Score="10" />
              </Range>
              <Range>
                <From Value="15000" Score="8" />
              </Range>
              <Range>
                <From Value="30000" Score="5" />
              </Range>
              <Range>
                <From Value="60000" Score="2" />
              </Range>
              <Range>
                <From Value="120000" Score="0" />
              </Range>
            </Ranges>
          </Normalization>
          <Document>
            <Sections>
              <Section>
                <Title>Description</Title>
                <Description>
									This score reprensents the average boot duration of the device.
								</Description>
              </Section>
              <Section>
                <Title>Values</Title>
                <Description>
									If the boot duration is:

									• Between 0 and 15 seconds -&gt; score is 10

									• Between 15 and 30 seconds -&gt; score is 8

									• Between 30 and 60 seconds -&gt; score is 5

									• Between 60 and 120 seconds -&gt; score is 2

									• More than 120 seconds -&gt; score is 0
								</Description>
              </Section>
            </Sections>
          </Document>
        </LeafScore>
      </CompositeScore>
    </CompositeScore>
    <CompositeScore UID="002db3fb-5678-475f-a099-f6071c53976d" Name="Network" Description="Indicates the overall network score." Visibility="visible" Weight="1">
      <Operation>
        <WeightedAverage />
      </Operation>
      <LeafScore UID="6a46a13a-03f2-483f-b0e0-da3a58f7a677" Name="Network availability" Description="Indicates the network availability score" Visibility="visible" Weight="1">
        <Input>
          <Computation Name="Successful connections ratio last 7 days" Description="" UID="ef049c25-9178-4c67-9feb-683327db860e">
            <Query Output="successful_connections_ratio" DefaultOutputValue="NULL">
							(select (id)
							(from device
							(with connection
							(compute successful_connections_ratio)
							(between now-7d now))))
						</Query>
          </Computation>
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0" Score="0" />
            </Range>
            <Range>
              <From Value="0.9" Score="5" />
            </Range>
            <Range>
              <From Value="0.98" Score="10" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								This score represents the successful connections ratio of all TCP connections during the last 7 days.
							</Description>
            </Section>
            <Section>
              <Title>Values</Title>
              <Description>
								If the value is:

								• Between 0% and 90% -&gt; score is 0

								• Between 90% and 98% -&gt; score is 5

								• Over 98% -&gt; score is 10
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3EFailed%20connection%20last%207%20days%3C%2FLabel%3E%3CObject%3Econnection%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Etype%3C%2Fstring%3E%3Cstring%3Estatus%3C%2Fstring%3E%3Cstring%3Elifespan%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3Cstring%3Esource%3C%2Fstring%3E%3Cstring%3Eproduct_name%3C%2Fstring%3E%3Cstring%3Eapplication_name%3C%2Fstring%3E%3Cstring%3Eport_number%3C%2Fstring%3E%3Cstring%3Edestination%3C%2Fstring%3E%3Cstring%3Esync_ack%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Econnection%3C%2FObject%3E%3CField%3Estatus%3C%2FField%3E%3CComparer%3E%21%3D%3C%2FComparer%3E%3CValue%3Eclosed%3C%2FValue%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Econnection%3C%2FObject%3E%3CField%3Estatus%3C%2FField%3E%3CComparer%3E%21%3D%3C%2FComparer%3E%3CValue%3Eestablished%3C%2FValue%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%20AND%203%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">Failed connections last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
      <LeafScore UID="b7000804-922a-45d7-a8a9-de962a7a8e67" Name="Network response time" Description="Indicates the average network response time during the last 7 days" Visibility="visible" Weight="1">
        <Input>
          <Computation Name="Response time last 7 days" Description="" UID="fc953779-cceb-4726-8127-6221a7f29ba5">
            <Query Output="average_network_response_time" DefaultOutputValue="NULL">
							(select (id)
							(from device
							(with connection
							(compute average_network_response_time)
							(between now-7d now))))
						</Query>
          </Computation>
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0" Score="10" />
            </Range>
            <Range>
              <From Value="10000" Score="8" />
            </Range>
            <Range>
              <From Value="25000" Score="5" />
            </Range>
            <Range>
              <From Value="50000" Score="2" />
            </Range>
            <Range>
              <From Value="100000" Score="0" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								This score represents the average TCP connection establishment time during the last 7 days.
							</Description>
            </Section>
            <Section>
              <Title>Values</Title>
              <Description>
								If the time is:

								• Between 0 and 10 milliseconds -&gt; score is 10

								• Between 10 and 25 milliseconds -&gt; score is 8

								• Between 25 and 50 milliseconds -&gt; score is 5

								• Between 50 and 100 milliseconds -&gt; score is 2

								• More than 100 milliseconds -&gt; score is 0
							</Description>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
      <LeafScore UID="73700247-3e09-449f-9157-076457508f6b" Name="Failed Web Request (Client)" Description="Indicates the Number of failed web request 4xx in last 7 days" Visibility="visible" Weight="1">
        <Input>
          <Computation Name="Number of failed web request 4xx in last 7 days" Description="" UID="2636a3bd-6e74-4f6f-a1a3-9e00de4245ab">
            <Query Output="number_of_web_requests" DefaultOutputValue="0">
							(select (id)
							(from device
							(with web_request
							(where web_request
							(ge http_status (http_status_code 400))
							(lt http_status (http_status_code 500)))
							(compute number_of_web_requests)
							(between now-7d now))))
						</Query>
          </Computation>
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0" Score="10" />
              <To Value="50" Score="7" />
            </Range>
            <Range>
              <From Value="50" Score="7" />
              <To Value="200" Score="5" />
            </Range>
            <Range>
              <From Value="200" Score="5" />
              <To Value="500" Score="0" />
            </Range>
            <Range>
              <From Value="500" Score="0" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								This score represents the number of failed web requests with a 4xx status code during the last 7 days.

								Status 4xx are client side errors.
							</Description>
            </Section>
            <Section>
              <Title>Values</Title>
              <Description>
								If the number of requests:

								• Between 0 and 50 -&gt; score will linearly decrease from 10 to 7

								• Between 50 and 200 -&gt; score will linearly decrease from 7 to 5

								• Between 200 and 500 -&gt; score will linearly decrease from 5 to 0

								• More than 500 -&gt; score is
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3EFailed%20web%20request%20%28client%29%20last%207%20days%3C%2FLabel%3E%3CObject%3Eweb_request%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Elast_time%3C%2Fstring%3E%3Cstring%3Eduration%3C%2Fstring%3E%3Cstring%3Eavg_duration%3C%2Fstring%3E%3Cstring%3Eprotocol%3C%2Fstring%3E%3Cstring%3Eprotocol_version%3C%2Fstring%3E%3Cstring%3Ehttp_status%3C%2Fstring%3E%3Cstring%3Ecardinality%3C%2Fstring%3E%3Cstring%3Euser_name%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3Cstring%3Eproduct_name%3C%2Fstring%3E%3Cstring%3Edomain_name%3C%2Fstring%3E%3Cstring%3Etcp_in%3C%2Fstring%3E%3Cstring%3Etcp_out%3C%2Fstring%3E%3Cstring%3Esync_ack%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Eweb_request%3C%2FObject%3E%3CField%3Ehttp_status%3C%2FField%3E%3CComparer%3E%26gt%3B%3D%3C%2FComparer%3E%3CValue%3E400%3C%2FValue%3E%3COperand%3Einteger%3C%2FOperand%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Eweb_request%3C%2FObject%3E%3CField%3Ehttp_status%3C%2FField%3E%3CComparer%3E%26lt%3B%3D%3C%2FComparer%3E%3CValue%3E499%3C%2FValue%3E%3COperand%3Einteger%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%20AND%203%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">Failed web requests (client) last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
      <LeafScore UID="bb9bd9c9-81f1-491e-9ccf-36633cd9fe5a" Name="Failed Web Request (Server)" Description="Indicates the Number of failed web request 4xx in last 7 days" Visibility="visible" Weight="1">
        <Input>
          <Computation Name="Number of failed web request 5xx in last 7 days" Description="" UID="84e372c4-8ec8-4040-86df-d642e9fcb786">
            <Query Output="number_of_web_requests" DefaultOutputValue="0">
							(select (id)
							(from device
							(with web_request
							(where web_request
							(ge http_status (http_status_code 500))
							(lt http_status (http_status_code 600)))
							(compute number_of_web_requests)
							(between now-7d now))))
						</Query>
          </Computation>
        </Input>
        <Normalization>
          <Ranges>
            <Range>
              <From Value="0" Score="10" />
              <To Value="50" Score="7" />
            </Range>
            <Range>
              <From Value="50" Score="7" />
              <To Value="200" Score="5" />
            </Range>
            <Range>
              <From Value="200" Score="5" />
              <To Value="500" Score="0" />
            </Range>
            <Range>
              <From Value="500" Score="0" />
            </Range>
          </Ranges>
        </Normalization>
        <Document>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								This score represents the number of failed web requests with a 5xx status code during the last 7 days.

								Status 5xx are server side errors.
							</Description>
            </Section>
            <Section>
              <Title>Values</Title>
              <Description>
								If the number of requests:

								• Between 0 and 50 -&gt; score will linearly decrease from 10 to 7

								• Between 50 and 200 -&gt; score will linearly decrease from 7 to 5

								• Between 200 and 500 -&gt; score will linearly decrease from 5 to 0

								• More than 500 -&gt; score is
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3EFailed%20web%20request%20%28server%29%20last%207%20days%3C%2FLabel%3E%3CObject%3Eweb_request%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Elast_time%3C%2Fstring%3E%3Cstring%3Eduration%3C%2Fstring%3E%3Cstring%3Eavg_duration%3C%2Fstring%3E%3Cstring%3Eprotocol%3C%2Fstring%3E%3Cstring%3Eprotocol_version%3C%2Fstring%3E%3Cstring%3Ehttp_status%3C%2Fstring%3E%3Cstring%3Ecardinality%3C%2Fstring%3E%3Cstring%3Euser_name%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3Cstring%3Eproduct_name%3C%2Fstring%3E%3Cstring%3Edomain_name%3C%2Fstring%3E%3Cstring%3Etcp_in%3C%2Fstring%3E%3Cstring%3Etcp_out%3C%2Fstring%3E%3Cstring%3Esync_ack%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Eweb_request%3C%2FObject%3E%3CField%3Ehttp_status%3C%2FField%3E%3CComparer%3E%26gt%3B%3D%3C%2FComparer%3E%3CValue%3E500%3C%2FValue%3E%3COperand%3Einteger%3C%2FOperand%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Eweb_request%3C%2FObject%3E%3CField%3Ehttp_status%3C%2FField%3E%3CComparer%3E%26lt%3B%3D%3C%2FComparer%3E%3CValue%3E599%3C%2FValue%3E%3COperand%3Einteger%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%20AND%203%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">Failed web requests (server) last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
      </LeafScore>
    </CompositeScore>
	<Document>
          <Sections>
            <Section>
              <Title>Description</Title>
              <Description>
								Based on the IT best practices used by software and hardware vendors, Nexthink uses an algorithm in charge of computing the values coming from the Collector and storing only one value, the result of the combination of the the S.M.A.R.T. values, the S.M.A.R.T. index.

								Having a low value for the S.M.A.R.T. index is not necessarily alarming as it won't tell you that the hard drive will fail or the endpoint system will have issues straight away or in 56 minutes or in 2 weeks. What it does tell you is that the values reported by the Collector are making us lower the degree of confidence we have in the hard drive. When the index value is very low, it's time to ask the IT technician to go on site and use the proprietary software to have the official diagnostic.

								Algorithm
								The algorithm will take the following items into account to estimate the index.

								• Power Cycle Count
								• Reallocation Event Count
								• Current Pending Sector Count
								• Reallocated Sectors Count
								• Uncorrectable Sector Count
								• Load Cycle Count
								• Write Error Rate

							</Description>
            </Section>
            <Section>
              <Title>Limitations</Title>
              <Description>
								• The hard disk manufacturers designing and producing the hardware and the associated software have their own protocol and have their own way of interrogating their components. This is not something that is necessarily publicly made available. A part of it maybe, but not all of it. So it is very difficult to provide detailed information about the actual state of the disk.

								• In order to reduce the space used by the Engine database and prevent the Engine process to be overloaded with S.M.A.R.T. values, the Engine does not keep the history of the S.M.A.R.T. values.
							</Description>
            </Section>
            <Section>
              <Title>Investigation</Title>
              <HTTP href="nxt://Run-NxInvestigation?Encoding=Url&amp;InvestigationXml=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-16%22%3F%3E%3CInvestigation%20xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20DataModelVersion%3D%2212%22%20SyntaxVersion%3D%223%22%3E%3CLabel%3ESmart%20disk%20failure%20last%207%20days%3C%2FLabel%3E%3CObject%3Esource_error%3C%2FObject%3E%3CPlatforms%3E%3CPlatform%3Ewindows%3C%2FPlatform%3E%3C%2FPlatforms%3E%3CDescription%20%2F%3E%3CFieldList%3E%3Cstring%3Etime%3C%2Fstring%3E%3Cstring%3Esource_name%3C%2Fstring%3E%3Cstring%3Evalue%3C%2Fstring%3E%3Cstring%3Einfo%3C%2Fstring%3E%3C%2FFieldList%3E%3CCategoryList%20%2F%3E%3CAggregateList%20%2F%3E%3CObjectConditionList%3E%3CObjectCondition%20IsTemplate%3D%22false%22%3E%3CObject%3Esource_error%3C%2FObject%3E%3CField%3Estatus%3C%2FField%3E%3CComparer%3E%3D%3C%2FComparer%3E%3CValue%3Esmart%3C%2FValue%3E%3C%2FObjectCondition%3E%3CObjectCondition%20IsTemplate%3D%22true%22%3E%3CObject%3Esource%3C%2FObject%3E%3CField%3Ename%3C%2FField%3E%3CComparer%3Elike%3C%2FComparer%3E%3CValue%20%2F%3E%3COperand%3Epattern%3C%2FOperand%3E%3C%2FObjectCondition%3E%3C%2FObjectConditionList%3E%3CObjectsConditionsExpression%3E1%20AND%202%3C%2FObjectsConditionsExpression%3E%3COrderBy%3Etime%3C%2FOrderBy%3E%3CLastDays%3E7%3C%2FLastDays%3E%3COrderDirection%3Edesc%3C%2FOrderDirection%3E%3CLimit%3E9999%3C%2FLimit%3E%3C%2FInvestigation%3E">List of Smart disk failure during last 7 days</HTTP>
            </Section>
          </Sections>
        </Document>
  </CompositeScore>
</ScoreDef>